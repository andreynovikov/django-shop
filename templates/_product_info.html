{% load static %}
{% load decimals %}
{% load string_filters %}
{% load shop_filters %}
<!-- product -->
<div class="sw-p-l panel panel-default">
<div class="panel-body">
<form class="update form-inline ajax" action="{% url 'shop:update' product.id %}" method="post">
{% csrf_token %}
<div class="sw-p-l-image text-center">
{% if product.variations %}
<a href="{{ product.variations }}">
{% else %}
<a class="opener-product" href="{% url 'product' product.code %}">
{% endif %}
{% if product.image_prefix|add:'.s.jpg'|file_exists %}
<img src="{{ MEDIA_URL }}{{ product.image_prefix }}.s.jpg" alt="{{ product.title }} {{ product.whatis }}" />
{% endif %}
</a>
</div>
<div class="sw-p-l-name">
<div class="sw-p-l-action">
{% if product.isnew %}
<span class="label sw-new">Новинка</span>
{% endif %}
{% if product.recomended %}
<span class="label sw-recomended">Рекомендуем</span>
{% endif %}
{% for action in product.get_sales_actions %}
{% if action.notice %}
<span class="label sw-action">{{ action.notice }}</p>
{% endif %}
{% endfor %}
</div>
<h3 class="sw-p-l-name-h">
{% if product.variations %}
<a href="{{ product.variations }}">
{% else %}
<a class="opener-product" href="{% url 'product' product.code %}">
{% endif %}
{{ product.title|remove:"Dor Tak" }}</a></h3>
{% if product.whatis %}
<p>
{% if product.variations %}
<a href="{{ product.variations }}">
{% else %}
<a class="opener-product" href="{% url 'product' product.code %}">
{% endif %}
{{ product.whatis }}</a></p>
{% endif %}
<div class="sw-p-l-brif">
{{ product.shortdescr|safe }}
</div>
</div>
{% if product.price > 0 %}
<div class="sw-p-l-buy">
{% if product.variations %}
<div><a href="{{ product.variations }}" class="btn btn-sm btn-success sw-addProduct-sm" role="button">Выбрать</a></div>
{% else %}
{% if product.instock > 0 %}
<div class="input-group spinner quantity-container" data-trigger="spinner">
  <span class="input-group-btn sw-minus"><button type="button" class="btn btn-sm btn-success" aria-label="-" data-spin="down">-</button></span>
  <input class="form-control input-sm text-center sw-basket-quantity" type="text" name="quantity" value="{{ quantity }}" data-min="0"
         {% if product.ws_pack_only %}data-step="{{ product.pack_factor }}"{% endif %} size="3"
         data-delay="1000" id="spinner{{ product.id }}" autocomplete="off" />
  <span class="input-group-btn sw-plus"><button  type="button" class="btn btn-sm btn-success" aria-label="+" data-spin="up">+</button></span>
</div>
{% else %}
<div class="product-nal-false">Закончились</div>
{% endif %}
{% endif %}
</div>
<div class="sw-p-l-prices">
<span class="sw-p-l-price">{{ cost|floatformat:"-2" }}</span>&#8239;&#8381;{% if product.ws_pack_only %}/шт.{% endif %}
{% if product.ws_pack_only and product.pack_factor != 1 %}
Продажа упаковками по {{ product.pack_factor }} шт.
{% endif %}
</div>
{% endif %}

{% if product.sales_notes %}
<div class="sw-p-salesnotes text-center">{{ product.sales_notes }}</div>
{% endif %}

</form>
</div>
</div>
<!-- /product -->
