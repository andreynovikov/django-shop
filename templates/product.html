{% extends "base.html" %}
{% load staticfiles %}
{% load decimals %}
{% load render_as_template %}
{% load shop_filters %}
{% load mptt_tags %}
{% load reviews %}
{% load cache %}
{% load django_bootstrap_breadcrumbs %}
{% block title %}{{ product.title }}{% endblock %}
{% block link %}
{% if request.META.QUERY_STRING %}<link rel="canonical" href="https://www.sewing-world.ru{% url 'product' product.code %}" />{% endif %}
{% endblock link %}
{% block css %}
<style>
.pull-right .gl-star-rating-stars > span {
    width: 18px; height: 18px; background-size: 18px;
}
.product-nal-store-link {
    display: block;
}
ul.product-city-list, ul.product-city-list ul {
    margin: 0; padding: 0; list-style: none;
}
ul.product-city-list ul {
    padding-left: 20px;
}
ul.product-city-list li {
    margin: 0; padding: 0;
}
ul.product-city-list li li {
    margin: 0 0 3px; padding-left: 0;
}
</style>
{% endblock %}
{% block breadcrumbs %}
    {{ block.super }}
    {% breadcrumb "К первой странице" "/" %}
    {% breadcrumb "Каталог" "catalog" %}
    {% if category %}
    {% for node,structure in category.get_ancestors|tree_info %}
        {% if node.is_child_node %}
            {% breadcrumb node "category" node.get_path %}
        {% endif %}
    {% endfor %}
    {% breadcrumb category "category" category.get_path %}
    {% endif %}
{% endblock %}
{% block content %}
{% cache 1800 product product.id %}
<script>
gtm_products = [];
</script>
<div class="container">
<div class="product-page">
<div itemscope itemtype="http://schema.org/Product">
<div class="container-fluid">
<div class="row">
<div class="col-md-20">
<h1 class="prodname" itemprop="name">{{ product.title }}
<sup>
{% if product.ishot %}
<span class="label sw-action">Акция</span>
{% endif %}
{% if product.isnew %}
<span class="label sw-new">Новинка</span>
{% endif %}
{% if product.recomended %}
<span class="label sw-recomended">Рекомендуем</span>
{% endif %}
{% if product.utilisation %}
<span class="label sw-action">Скидка по "Утилизации"</span>
{% endif %}
</sup>
</h1>
</div>
<div class="col-md-4">
<div class="pull-right">
{% if product.manufacturer %}
{% if product.manufacturer.logo %}
<img class="hidden-xs hidden-sm" alt="{{ product.manufacturer.name }}" src="{{ product.manufacturer.logo.url }}" width="{{ product.manufacturer.logo_width }}" height="{{ product.manufacturer.logo_height }}"/>
<p class="hidden-md hidden-lg">Производитель: <strong>{{ product.manufacturer.name }}</strong></p>
{% else %}
<p><strong>{{ product.manufacturer.name }}</strong></p>
{% endif %}
{% endif %}
{% if product.partnumber %}
<p class="hidden-xs hidden-sm">Артикул: {{ product.partnumber }}</p>
<p class="hidden-md hidden-lg">Артикул: {{ product.partnumber }}</p>
{% endif %}
{% get_rating for product as product_rating %}
{% if product_rating %}
{% render_rating for product %}
{% endif %}
</div>
</div>
</div>
</div>

<div class="clearfix"></div>
{% if product.runame or product.whatis %}
<p>{{ product.whatis }} {{ product.runame }}</p>
{% endif %}


<div class="product-image">
{% if product.image_prefix|add:'.jpg'|file_exists %}
{% if product.image_prefix|add:'.b.jpg'|file_exists %}
<div class="popup-gallery"><a href="{{ MEDIA_URL }}{{ product.image_prefix }}.b.jpg">
{% endif %}
<img id="{{ product.id }}" src="{{ MEDIA_URL }}{{ product.image_prefix }}.jpg" alt="{{ product.title }} {{ product.whatis }}" itemprop="image"  class="img-responsive"/>
{% if product.image_prefix|add:'.b.jpg'|file_exists %}
</a></div>
{% endif %}
{% endif %}
</div>
{% endcache %}
<div class="panel panel-default product-buyblock">
<div class="panel-body product-buyblock-body">
{% if product.enabled %}
<div itemprop="offers" itemscope itemtype="http://schema.org/Offer">
{% if product.cost > 0 %}
{% if product.discount > 0 %}
<p class="oldprice">{{ product.price|quantize:"1" }}&nbsp;руб. <a href="#dialog_discount" class="opener"><img src="{% static 'i/icons/more_icon.png' %}"></a></p>
<div id="dialog_discount" class="mfp-hide white-popup-block">
<h4>Скидка!</h4>
<p>Базовая цена в магазинах &laquo;Швейный Мир&raquo; без учета скидок <b>{{ product.price|quantize:"1" }}&nbsp;руб.</b></p>
<p>Скидка при покупке в интернет-магазине составляет <b>{{ product.discount }}&nbsp;руб.</b></p>
</div>
{% endif %}{# discount > 0 #}
<p class="price"><span itemprop="price">{{ product.cost|quantize:"1" }}</span>&nbsp;руб.
{% if product.instock > 0 %}
<a href="{% url 'shop:add' product.id %}{% if utm_source %}?utm_source={{ utm_source }}{% endif %}" class="addProduct btn btn-success sw-addProduct-sm" role="button" id="p_{{ product.id }}">Купить</a>
{% else %}
<a href="{% url 'shop:add' product.id %}{% if utm_source %}?utm_source={{ utm_source }}{% endif %}" class="addProduct btn btn-success sw-addProduct-sm" role="button" id="p_{{ product.id }}">Сообщить о поступлении</a>
{% endif %}

<span itemprop="priceCurrency" style="visibility:hidden;font-size:1pt;margin:0;padding:0;width:0;height:0;line-height:0;">RUB</span>
{% if product.deshevle %}
<a href="{% url 'django.contrib.flatpages.views.flatpage' url='dialog/deshevle/' %}" class="opener-ajax deshevle">Нашли&nbsp;дешевле?</a>
{% endif %}
</p>
{% if product.credit_allowed and product.instock > 0 %}
<div id="yandex-credit" style="margin: -7pt 0 7pt"></div>
{% endif %}
{% endif %}{# cost > 0 #}

<p><span class="product-nal-caption">Наличие:</span>
{% if product.instock > 1 %}
<span class="product-nal-true">Есть</span>
{% endif %}
{% if product.instock == 1 %}
<span class="product-nal-true">Мало</span>
{% endif %}
{% if product.instock < 1 %}
<span class="product-nal-false">Нет</span>
{% endif %}
{% if product.cost > 0 %}
<a class="product-nal-store-link opener-ajax" href="{% url 'product_stock' product.code %}">Наличие в розничных магазинах</a>
{% endif %}
</p>
{% if product.state %}
<p>{{ product.state }}</p>
{% endif %}
{% if product.sales_notes %}
<p class="product-salesnotes">{{ product.sales_notes }}</p>
{% endif %}
{% for action in product.get_sales_actions %}
<p class="product-salesnotes">{% render_as_template action.brief %}</p>
{% endfor %}
{% if product.utilisation %}
<p class="product-salesnotes">Участник акции <a href="/actions/utilisation.html">"Утилизация"</a>! Скидка по акции <span class="price">{{ maxdiscount }}%</span>!</p>
{% endif %}

{% if product.warranty and product.price > 0 and not product.state and 1 > 2 %}
<p>Легко вернуть в случае неисправности.
<a href="{% url 'django.contrib.flatpages.views.flatpage' url='dialog/back/' %}" class="opener-ajax"><img src="{% static 'i/icons/more_icon.png' %}"></a></p>
{% endif %}

{% with product as parent %}
{% for product in gifts %}
{% if forloop.first %}
<p class="product-gift">Покупая {{ parent.title }} в интернет-магазине, Вы получите подарок:</p>
<div class="text-center">
{% endif %}
{% include "_product_info.html" %}
{% if forloop.last %}
</div>
{% endif %}
{% endfor %}
{% endwith %}
{% if product.article %}
<div style="color:#888888;"><small>Код товара: {{ product.article }}</small></div>
{% endif %}
</div>
{% else %}
<span class="product-nal-false">Товар снят с продажи</span>
{% endif %}{# enabled #}
</div>
</div>
{% cache 3600 product_description product.id %}
{% if product.images %}
<div class="popup-gallery">
{% for image in product.images %}
<a href="{{ MEDIA_URL }}{{ product.image_prefix }}/{{image}}.jpg"><img src="{{ MEDIA_URL }}{{ product.image_prefix }}/{{image}}.s.jpg" alt="{{ product.title }} - Фото №{{ forloop.counter }}" border="0" /></a>
{% endfor %}
</div>
{% endif %}

<!-- constituents -->
{% if constituents %}
<h2>Состав комплекта:</h2>
{% for item in constituents %}
{% with item.constituent as product %}
<div class="sw-p-l panel panel-default">
<div class="panel-body">
<div class="sw-p-l-image text-center">
<a href="{% url 'product' product.code %}">
{% if product.image_prefix|add:'.s.jpg'|file_exists %}
<img src="{{ MEDIA_URL }}{{ product.image_prefix }}.s.jpg" alt="{{ product.title }} {{ product.whatis }}" />
{% endif %}
</a>
</div>
<div class="sw-p-l-name">
<div class="sw-p-l-action">
</div>
<h3 class="sw-p-l-name-h">
<a href="{% url 'product' product.code %}">{{ product.title }}</a>{% if item.quantity > 1 %} ({{ item.quantity }} шт.){% endif %}</h3>
<p>
<a href="{% url 'product' product.code %}">{{ product.whatis }} {{ product.partnumber }}</a></p>
<div class="sw-p-l-brif">
{{ product.shortdescr|safe }}
</div>
</div>
</div>
</div>
{% endwith %}
{% endfor %}
{% endif %}
<!-- /constituents -->

{% if product.descr %}
<p itemprop="description">{{ product.descr|safe }}</p>
{% endif %}
{% if product.spec %}
<p>{{ product.spec|safe }}</p>
{% endif %}

{% if product.warranty %}
<h2>Характеристики {{ product.title }}:</h2>
{% endif %}
<dl class="product-spec">
{% if product.fabric_verylite %}
<dt><span>Диапазон прошиваемых материалов <a class="opener-html" href="/blog/?p=464"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>Очень легкие – {{ product.fabric_verylite }}<br>Легкие – {{ product.fabric_lite }}<br>Средние и умеренно тяжелые – {{ product.fabric_medium }}<br>Тяжелые – {{ product.fabric_hard }}<br>Трикотаж – {{ product.fabric_stretch }}</dd>
{% endif %}
{% if product.km_class %}
<dt><span>Класс машины <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/km_class/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.km_class }}</dd>
{% endif %}
{% if product.km_font %}
<dt><span>Количество фонтур <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/km_font/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.km_font }}</dd>
{% endif %}
{% if product.km_needles %}
<dt><span>Количество игл</span></dt><dd>{{ product.km_needles }}</dd>
{% endif %}
{% if product.km_prog %}
<dt><span>Способ программирования</span></dt><dd>{{ product.km_prog }}</dd>
{% endif %}
{% if product.km_rapport %}
<dt><span>Раппорт программируемого рисунка</span></dt><dd>{{ product.km_rapport }}</dd>
{% endif %}
{% if product.sw_hoopsize %}
<dt><span>Размер пялец <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sw_hoopsize/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sw_hoopsize }}</dd>
{% endif %}
{% if product.sw_datalink %}
<dt><span>Способ связи с компьютером <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sw_datalink/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sw_datalink }}</dd>
{% endif %}
{% if product.sm_software %}
<dt><span>Возможности встроенного ПО</span></dt><dd>{{ product.sm_software }}</dd>
{% endif %}
{% if product.sm_shuttletype %}
<dt><span>Тип челнока <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_shuttletype/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_shuttletype }}</dd>
{% endif %}
{% if product.sm_stitchwidth %}
<dt><span>Максимальная ширина строчки <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_stitchlength/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_stitchwidth }} мм</dd>
{% endif %}
{% if product.sm_stitchlenght %}
<dt><span>Максимальная длина стежка <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_stitchlength/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_stitchlenght }} мм</dd>
{% endif %}
{% if product.sm_maxi %}
<dt><span>Макси-узоры <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_maxi/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_maxi }}</dd>
{% endif %}
{% if product.sm_stitchquantity %}
<dt><span>Количество строчек <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_stitchquantity/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_stitchquantity }}</dd>
{% endif %}
{% if product.sm_buttonhole %}
<dt><span>Режим вымётывания петли <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_buttonhole/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_buttonhole }}</dd>
{% endif %}
{% if product.sm_alphabet %}
<dt><span>Алфавит <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_alphabet/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_alphabet }}</dd>
{% endif %}
{% if product.sm_dualtransporter %}
<dt><span>Верхний транспортёр <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_dualtransporter/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_dualtransporter }}</dd>
{% endif %}
{% if product.sm_platformlenght %}
<dt><span>Длина платформы <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_platformlenght/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_platformlenght }} см</dd>
{% endif %}
{% if product.sm_freearm %}
<dt><span>Размеры рукавной платформы (длина/обхват) <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_freearm/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_freearm }} см</dd>
{% endif %}
{% if product.sm_feedwidth %}
<dt><span>Ширина гребёнки транспортера <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_feedwidth/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_feedwidth }} мм</dd>
{% endif %}
{% if product.sm_footheight %}
<dt><span>Высота подъема лапки (нормальная/максимальная) <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_footheight/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_footheight }}</dd>
{% endif %}
{% if product.sm_constant %}
<dt><span>Электронный стабилизатор усилия прокола <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_constant/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_constant }}</dd>
{% endif %}
{% if product.sm_speedcontrol %}
<dt><span>Регулятор (ограничитель) максимальной скорости <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_speedcontrol/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_speedcontrol }}</dd>
{% endif %}
{% if product.sm_needleupdown %}
<dt><span>Программируемая остановка иглы в верхнем/нижнем положении <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_needleupdown/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_needleupdown }}</dd>
{% endif %}
{% if product.sm_threader %}
<dt><span>Нитевдеватель <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_threader/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_threader }}</dd>
{% endif %}
{% if product.sm_autocutter %}
<dt><span>Автоматическая обрезка нитей</span></dt><dd>{{ product.sm_autocutter }}</dd>
{% endif %}
{% if product.sm_spool %}
<dt><span>Горизонтальное расположение катушки <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_spool/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_spool }}</dd>
{% endif %}
{% if product.sm_presscontrol %}
<dt><span>Регулятор давления лапки <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_presscontrol/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_presscontrol }}</dd>
{% endif %}
{% if product.sm_power %}
<dt><span>Потребляемая мощность <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_power/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_power }} Вт</dd>
{% endif %}
{% if product.sm_light %}
<dt><span>Тип освещения </span></dt><dd>{{ product.sm_light }}</dd>
{% endif %}
{% if product.sm_organizer %}
<dt><span>Органайзер <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_organizer/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_organizer }}</dd>
{% endif %}
{% if product.sm_autostop %}
<dt><span>Автостоп при намотке нитки на шпульку <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_autostop/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_autostop }}</dd>
{% endif %}
{% if product.sm_ruler %}
<dt><span>Линейка на корпусе <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_ruler/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_ruler }}</dd>
{% endif %}
{% if product.sm_cover %}
<dt><span>Чехол <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_cover/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_cover }}</dd>
{% endif %}
{% if product.sm_display %}
<dt><span>Дисплей</span></dt><dd>{{ product.sm_display }}</dd>
{% endif %}
{% if product.sm_russian %}
<dt><span>Русское меню</span></dt><dd>{{ product.sm_russian }}</dd>
{% endif %}
{% if product.sm_advisor %}
<dt><span>Швейный советник <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_advisor/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_advisor }}</dd>
{% endif %}
{% if product.sm_memory %}
<dt><span>Память</span></dt><dd>{{ product.sm_memory }}</dd>
{% endif %}
{% if product.sm_mirror %}
<dt><span>Зеркальное отображение образца строчки</span></dt><dd>{{ product.sm_mirror }}</dd>
{% endif %}
{% if product.sm_startstop %}
<dt><span>Клавиша шитья без педали <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_startstop/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_startstop }}</dd>
{% endif %}
{% if product.sm_kneelift %}
<dt><span>Коленный рычаг подъема лапки <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_kneelift/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_kneelift }}</dd>
{% endif %}
{% if product.sm_diffeed %}
<dt><span>Дифференциальный транспортер ткани <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_diffeed/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_diffeed }}</dd>
{% endif %}
{% if product.sm_easythreading %}
<dt><span>Облегченная заправка петлителей <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_easythreading/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_easythreading }}</dd>
{% endif %}
{% if product.ov_freearm %}
<dt><span>Рукавная платформа</span></dt><dd>{{ product.ov_freearm }}</dd>
{% endif %}
{% if product.sm_needles %}
<dt><span>Стандарт игл <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_needles/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_needles }}</dd>
{% endif %}
{% if product.developer_country and product.developer_country.enabled %}
<dt><span>Страна разработки</span></dt><dd>{{ product.developer_country.name }}</dd>
{% endif %}
{% if product.country and product.country.enabled %}
<dt><span>Страна производства</span></dt><dd>{{ product.country.name }}</dd>
{% endif %}
{% if product.warranty %}
<dt><span>Гарантия</span></dt><dd>{{ product.warranty }}</dd>
{% endif %}

{% if product.prom_transporter_type %}
<dt><span>Тип транспортера</span></dt><dd>{{ product.prom_transporter_type }}</dd>
{% endif %}
{% if product.prom_shuttle_type %}
<dt><span>Тип челнока</span></dt><dd>{{ product.prom_shuttle_type }}</dd>
{% endif %}
{% if product.prom_speed %}
<dt><span>Максимальная скорость шитья</span></dt><dd>{{ product.prom_speed }}</dd>
{% endif %}
{% if product.prom_needle_type %}
<dt><span>Размер и тип иглы</span></dt><dd>{{ product.prom_needle_type }}</dd>
{% endif %}
{% if product.prom_stitch_lenght %}
<dt><span>Длина стежка</span></dt><dd>{{ product.prom_stitch_lenght }}</dd>
{% endif %}
{% if product.prom_foot_lift %}
<dt><span>Высота подъема лапки</span></dt><dd>{{ product.prom_foot_lift }}</dd>
{% endif %}
{% if product.prom_fabric_type %}
<dt><span>Тип материала</span></dt><dd>{{ product.prom_fabric_type }}</dd>
{% endif %}
{% if product.prom_oil_type %}
<dt><span>Тип смазки</span></dt><dd>{{ product.prom_oil_type }}</dd>
{% endif %}
{% if product.weight %}
<dt><span>Вес без упаковки</span></dt><dd>{{ product.weight }} кг</dd>
{% endif %}
{% if product.prom_weight %}
<dt><span>Вес в упаковке</span></dt><dd>{{ product.prom_weight }} кг</dd>
{% endif %}
{% if product.prom_cutting %}
<dt><span>Обрезка нити</span></dt><dd>{{ product.prom_cutting }}</dd>
{% endif %}
{% if product.prom_threads_num %}
<dt><span>Количество нитей</span></dt><dd>{{ product.prom_threads_num }}</dd>
{% endif %}
{% if product.prom_power %}
<dt><span>Мощность</span></dt><dd>{{ product.prom_power }}</dd>
{% endif %}
{% if product.prom_bhlenght %}
<dt><span>Длина петли</span></dt><dd>{{ product.prom_bhlenght }}</dd>
{% endif %}
{% if product.prom_overstitch_lenght %}
<dt><span>Максимальная длина обметочного стежка</span></dt><dd>{{ product.prom_overstitch_lenght }}</dd>
{% endif %}
{% if product.prom_overstitch_width %}
<dt><span>Максимальная ширина обметочного стежка</span></dt><dd>{{ product.prom_overstitch_width }}</dd>
{% endif %}
{% if product.prom_stitch_width %}
<dt><span>Ширина зигзагообразной строчки</span></dt><dd>{{ product.prom_stitch_width }}</dd>
{% endif %}
{% if product.prom_needle_width %}
<dt><span>Расстояние между иглами</span></dt><dd>{{ product.prom_needle_width }}</dd>
{% endif %}
{% if product.prom_needle_num %}
<dt><span>Количество игл</span></dt><dd>{{ product.prom_needle_num }}</dd>
{% endif %}
{% if product.prom_platform_type %}
<dt><span>Тип платформы</span></dt><dd>{{ product.prom_platform_type }}</dd>
{% endif %}
{% if product.prom_button_diaouter %}
<dt><span>Наружный диаметр пуговицы</span></dt><dd>{{ product.prom_button_diaouter }}</dd>
{% endif %}
{% if product.prom_button_diainner %}
<dt><span>Внутренний диаметр пуговицы</span></dt><dd>{{ product.prom_button_diainner }}</dd>
{% endif %}
{% if product.prom_needle_height %}
<dt><span>Ход игловодителя</span></dt><dd>{{ product.prom_needle_height }}</dd>
{% endif %}
{% if product.prom_stitch_type %}
<dt><span>Тип стежка</span></dt><dd>{{ product.prom_stitch_type }}</dd>
{% endif %}
{% if product.prom_autothread %}
<dt><span>Автоматический нитеотводчик</span></dt><dd>{{ product.prom_autothread }}</dd>
{% endif %}
</dl>

{% if 'images/'|add:product.manufacturer.name|add:'/stitches/'|add:product.code|add:'_stitches.jpg'|file_exists or product.stitches %}
<h2>Строчки {{ product.title }}:</h2>
{% if 'images/'|add:product.manufacturer.name|add:'/stitches/'|add:product.code|add:'_stitches.jpg'|file_exists %}
<p><img src="{{ MEDIA_URL }}/images/{{ product.manufacturer.name }}/stitches/{{ product.code }}_stitches.jpg" alt="Строчки швейной машины {{ product.title }}" class="img-responsive"></p>
{% endif %}
{% if product.stitches %}
{{ product.stitches|safe }}
{% endif %}
{% endif %}

{% if product.complect %}
<h2>Комплектация</h2>
<p>{{ product.complect|safe }}</p>
{% endif %}

{% with product as parent %}
{% for product in accessories %}
{% if forloop.first %}
<h2>Популярные аксессуары для {{ parent.title }}</h2>
{% endif %}
{% include "_product_info.html" %}
<script>
gtm_products.push({'name':'{{ product.title }}','id':'{{ product.id }}','price':'{{ product.price }}','brand':'{{ product.manufacturer.code }}','list':'Сопутствующие товары','position':{{ forloop.counter }}});
</script>
{% endfor %}
{% for product in similar %}
{% if forloop.first %}
<h2>Товары похожие на {{ parent.title }}</h2>
{% endif %}
{% include "_product_info.html" %}
<script>
gtm_products.push({'name':'{{ product.title }}','id':'{{ product.id }}','price':'{{ product.price }}','brand':'{{ product.manufacturer.code }}','list':'Похожие товары','position':{{ forloop.counter }}});
</script>
{% endfor %}
{% endwith %}

{% if product.dealertxt %}
<h2>Обратите внимание!</h2>
<p>{{ product.dealertxt }}</p>
{% endif %}
{% endcache %}

{% if product.allow_reviews %}
  {% get_review_count for product as review_count %}
  {% if review_count %}
    <h2>Отзывы о товаре {{ product.title }}</h2>
    {% render_review_list for product %}
  {% else %}
    <h2>Опубликуйте ваш отзыв</h2>
  {% endif %}
  {% if request.user.is_authenticated %}
    {% get_review_by_user for product as user_review %}
    {% if user_review %}
      <p>Вы уже оставляли отзыв о данном товаре.
         {% if not user_review.is_public %}Если вы его не видите, он может быть отклонён или ещё проверяться модератором.{% endif %}
         Вы можете <a href="{% url 'review_product' product.code %}">изменить свой отзыв</a> в любой момент.</p>
    {% else %}
      {% if review_count %}
      <p>Вы тоже можете <a href="{% url 'review_product' product.code %}">оставить свой отзыв</a> о данном товаре.</p>
      {% else %}
      <p>Вы можете быть первым, <a href="{% url 'review_product' product.code %}">кто опубликует отзыв</a> об этом товаре.</p>
      {% endif %}
    {% endif %}
  {% else %}
    <p>Отзывы о товаре могут оставлять только <a href="{% url 'shop:login' %}?next={% url 'review_product' product.code %}">зарегистрированные</a> покупатели.</p>
  {% endif %}
{% endif %}
</div>
</div> <!--- /product-page --->

<noscript>
<div style="display:inline;">
<img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/826531590/?guid=ON&amp;script=0"/>
</div>
</noscript>
</div>
{% endblock content %}
{% block javascript %}
{% if product.credit_allowed and product.instock > 0 %}
<script src="https://static.yandex.net/kassa/pay-in-parts/ui/v1"></script>
{% endif %}
<script>
$(document).ready(function() {
  dataLayer.push({'ecommerce':{'currencyCode':'RUB','impressions':gtm_products,'detail':{'products': [{'id':'{{ product.id }}','name':'{{ product.partnumber }} {{ product.title }}','category':'{{ category.name }}','brand':'{{ product.manufacturer.code }}','price':'{{ product.cost }}'}]}
  }});
  
{% if product.credit_allowed and product.instock > 0 %}
  const $checkoutCreditUI = YandexCheckoutCreditUI({ shopId: '42873', sum: '{{ product.cost|quantize:"1" }}' });
  const checkoutCreditText = $checkoutCreditUI({ type: 'info', domSelector: '#yandex-credit' });
{% endif %}
});

$('#p_{{ product.id }}').click(function(){
  dataLayer.push({'event': 'addToCart','ecommerce': {'currencyCode': 'RUB','add': {'products': [{'name':'{{ product.partnumber}} {{ product.title }}','id':'{{ product.id }}','category':'{{ category.name }}','brand':'{{ product.manufacturer.code }}','price':'{{ product.cost|quantize:"1" }}','quantity': 1}]}}
  });
  var VK_add_to_cart_Params = {'products': [{'id': '{{ product.id }}'}]};
  VK.Retargeting.ProductEvent(3195, "add_to_cart", VK_add_to_cart_Params);
});

var google_tag_params = {
ecomm_prodid: '{{ product.id }}',
ecomm_pagetype: 'product',
ecomm_totalvalue: {{ product.cost|quantize:"1" }},
};

/* <![CDATA[ */
var google_conversion_id = 826531590;
var google_custom_params = window.google_tag_params;
var google_remarketing_only = true;
/* ]]> */
</script>
<script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js"></script>
{% endblock javascript %}
{% block vk_retargeting %}
<script>
$(document).ready(function() {
  /* продукт для динамического ретаргетинга ВК */
  var eventParams = {'products': [{'id': '{{ product.id }}'}], 'category_ids':'{{ category.id }},473', 'products_recommended_ids':
    '{% with product as parent %}{% for product in accessories %}{{ product.id }},{% endfor %}{% for product in similar %}{{ product.id }},{% endfor %}{% endwith %}12476,11820'
  }; 
  VK.Retargeting.ProductEvent(3195, "view_product", eventParams);
});
</script>
{% endblock vk_retargeting %}
