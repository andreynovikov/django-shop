{% extends "base.html" %}
{% load staticfiles %}
{% load decimals %}
{% load shop_filters %}
{% load mptt_tags %}
{% load django_bootstrap_breadcrumbs %}
{% block title %}
<title>{{ product.title }}</title>
{% endblock %}
{% block css %}
<style type="text/css">
.product-page          { max-width:1000px; margin: 0 auto; }
.product-page h2       { font-size:1.4em; border-bottom:1px solid #e0e0e0; padding-bottom:5px; margin-top:40px; margin-bottom:20px; }
.product-buyblock      { float:none; display:inline-block; vertical-align:top;}
@media(max-width:768px){
.product-buyblock      { width:100%; }
.product-buyblock-body { max-width:320px; text-align:center;}
.product-image         { width:100%; }
.product-image .popup-gallery { max-width:600px; margin: 0 auto; text-align:center;}
}
@media(min-width:768px){
.product-buyblock      { max-width:380px; }
}
.panel-body {padding:3px;padding-top:10px;}
.product-image        { float:none; display:inline-block; vertical-align:top; }
.product-nal-caption  { font-weight:bold; }
.product-nal-true     { color:#4cae4c; font-weight:bold; }
.product-nal-false    { color:#aaaaaa; font-weight:bold; }
.product-delivery-caption { font-weight:bold; }
.product-salesnotes, .product-gift  { color:@brand-orange; }
.price                { font-size:1.2em; font-weight:bold; }
.price span           { color:@brand-orange; font-size:1.4em; }
.oldprice             { text-decoration:line-through; }
.product-spec         { display: block; position:relative; margin:0; }
.product-spec dt      { display: inline-block; width: 49%; margin: 0 0 7px; vertical-align: top;}
.product-spec dd      { display: inline-block; width: 50%; margin: 0 0 7px; vertical-align: bottom; background: inherit; }
.product-spec dt span { font-weight:normal; }
.product-spec dt:after { position: absolute; content:"";  }

.modelProperties td	{padding-right:0;padding-bottom:0;padding-left:0;vertical-align: bottom;}
.modelProperties td.sw-label	{padding-right:10;padding-bottom:0;padding-left:0;line-height:1.2em;}
.modelProperties span	{background-color:white;}


/* для подсказки */
.opener img, .opener-ajax img, .opener-html img { opacity: 0.5; width: 14px; height: 14px; border:0; border-spacing:0; }
.white-popup-block            {background: white;padding: 20px 30px;text-align: left;max-width: 800px;margin: 40px auto;position: relative;}
.white-popup-block img        {margin:10px}
.popup-gallery                { margin-top:5px; }

.price .sw-addProduct-sm      { margin-bottom:5px; }
.sw-addProduct-sm     { font-weight:bold; text-decoration:none; }
</style>
{% endblock %}





{% block breadcrumbs %}
    {{ block.super }}
    {% breadcrumb "К первой странице" "/" %}
    {% breadcrumb "Каталог" "catalog" %}
    {% if product.breadcrumbs %}
    {% for node,structure in product.breadcrumbs|tree_info %}
        {% if node.is_child_node %}
            {% breadcrumb node "category" node.get_path %}
        {% endif %}
    {% endfor %}
    {% endif %}
{% endblock %}
{% block content %}
<div class="products">
<div itemscope itemtype="http://schema.org/Product">
<h1 itemprop="name">{{ product.title }}
<sup>
{% if product.ishot %}
<span class="label label-warning">Акция</span>
{% endif %}
{% if product.isnew %}
<span class="label label-danger">Новинка</span>
{% endif %}
{% if product.recomended %}
<span class="label label-success">Рекомендуем</span>
{% endif %}
</sup>
</h1>

{% if product.partnumber %}
<p>Код производителя: {{ product.partnumber }}</p>
{% endif %}
{% if product.runame or product.whatis %}
<p>{{ product.whatis }} {{ product.runame }}</p>
{% endif %}


<div class="product-image">
{% if product.image_prefix|add:'.jpg'|file_exists %}
{% if product.image_prefix|add:'.b.jpg'|file_exists %}
<div class="popup-gallery"><a href="{{ MEDIA_URL }}{{ product.image_prefix }}.b.jpg">
{% endif %}
<img  style="max-width:540px; height:auto;" id="{{ product.id }}" src="{{ MEDIA_URL }}{{ product.image_prefix }}.jpg" alt="{{ product.title }} {{ product.whatis }}" itemprop="image"  class="img-responsive"/>
{% if product.image_prefix|add:'.b.jpg'|file_exists %}
</a></div>
{% endif %}
{% endif %}
</div>

<div class="panel panel-default product-buyblock">
<div class="panel-body product-buyblock-body">
<div itemprop="offers" itemscope itemtype="http://schema.org/Offer">
{% if product.discount > 0 %}
<p class="oldprice">{{ product.price|quantize:"1" }}&nbsp;руб. <a href="#dialog_discount" class="opener"><img src="{% static 'i/icons/more_icon.png' %}"></a></p>
{% endif %}
<p class="price"><span itemprop="price">{{ product.cost|quantize:"1" }}</span>&nbsp;руб.

{% if product.instock > 0 %}
<a href="{% url 'shop:add' product.id %}"
class="addProduct btn btn-success sw-addProduct-sm" role="button" id="p_{{ product.id }}">Купить</a>
{% else %}
<a href="{% url 'shop:add' product.id %}"
class="addProduct btn btn-success sw-addProduct-sm" role="button" id="p_{{ product.id }}">Сообщить о поступлении</a>
{% endif %}

<span itemprop="priceCurrency" style="visibility:hidden;font-size:1pt;margin:0;padding:0;width:0;height:0;line-height:0;">RUB</span>
</p>
{% if product.available %}
<p><span class="product-nal-caption">Наличие:</span>
{% if product.instock > 1 %}
<span class="product-nal-true">Есть</span>
{% endif %}
{% if product.instock == 1 %}
<span class="product-nal-true">Мало</span>
{% endif %}
{% if product.instock < 1 %}
<span class="product-nal-false">Нет</span>
{% endif %}
</p>
{% endif %}
{% if sales_notes %}
<p class="product-salesnotes">{{ sales_notes }}</p>
{% endif %}
{% if product.instock > 1 %}
<meta name="ydWidgetData" id="e87ab1a4b521b363e68df04de4866de4" content="" data-sender_id="15938" data-weight="10" data-cost="{{ product.cost }}" data-height="27" data-length="50" data-width="40" data-city_from="Москва" data-geo_id_from="213" data-css_name="geo_tpl" data-tpl_name="geo_tpl" data-container_tag_id="b1a118f6e3252a711b9146c1d41567e5" data-resource_id="21272" data-resource_key="1780931b94c77b42c08b895fb88747d2" data-tracking_method_key="43df8cf1b0d40baaef3a3363458314f1" data-autocomplete_method_key="fd34c231b276f9bea3db9b60ac09506e"></meta><!--[if lt IE 9]><script>document.createElement("msw");</script><![endif]-->
<script src="https://delivery.yandex.ru/widget/widgetJsLoader?dataTagID=e87ab1a4b521b363e68df04de4866de4" charset="utf-8"></script>
<msw id="b1a118f6e3252a711b9146c1d41567e5" class="yd-widget-container"></msw>
{% endif %}
</div>
</div>
</div>

{% if product.images %}
<div class="popup-gallery">
{% for image in product.images %}
<a href="{{ MEDIA_URL }}{{ product.image_prefix }}/{{image}}.jpg"><img src="{{ MEDIA_URL }}{{ product.image_prefix }}/{{image}}.s.jpg" alt="{{ product.title }} - Фото №{{ forloop.counter }}" border="0" /></a>
{% endfor %}
</div>
{% endif %}

{% if product.constituents.count %}
<h2>Состав комплекта:</h2>
<table style="margin-bottom: 10pt">
{% with product as parent %}
{% for product in parent.constituents.all %}
<tr><td>{% if product.image_prefix|add:'.s.jpg'|file_exists %}
<img src="{{ MEDIA_URL }}{{ product.image_prefix }}.s.jpg" alt="{{ product.title }} {{ product.whatis }}" />
{% endif %}</td>
<td style="padding-left: 6pt">
<h3 class="sw-p-l-name-h">
{% if product.variations %}
<a href="{{ product.variations }}">
{% else %}
<a href="{% url 'product' product.code %}">
{% endif %}
{{ product.title }}</a></h3>
<div class="sw-p-l-brif">
{{ product.shortdescr|safe }}
</div>
</td></tr>
<script>
gtm_products.push({'name':'{{ product.title }}','id':'{{ product.id }}','price':'{{ product.price }}','brand':'{{ product.manufacturer.code }}','list':'Состав комплекта','position':{{ forloop.counter }}});
</script>
{% endfor %}
{% endwith %}
</table>
{% endif %}

{% if product.descr %}
<p itemprop="description">{{ product.descr|safe }}</p>
{% endif %}


{% if product.warranty %}
<h2>Характеристики {{ product.title }}:</h2>
{% endif %}

<dl class="product-spec">
{% if product.fabric_verylite %}
<dt><span>Диапазон прошиваемых материалов</span></dt><dd>Очень легкие – {{ product.fabric_verylite }}<br>Легкие – {{ product.fabric_lite }}<br>Средние и умеренно тяжелые – {{ product.fabric_medium }}<br>Тяжелые – {{ product.fabric_hard }}<br>Трикотаж – {{ product.fabric_stretch }}</dd>
{% endif %}
{% if product.sm_shuttletype %}
<dt><span>Тип челнока <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_shuttletype/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_shuttletype }}</dd>
{% endif %}
{% if product.sm_stitchwidth %}
<dt><span>Максимальная ширина строчки <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_stitchlength/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_stitchwidth }} мм</dd>
{% endif %}
{% if product.sm_stitchlenght %}
<dt><span>Максимальная длина стежка <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_stitchlength/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_stitchlenght }} мм</dd>
{% endif %}
{% if product.sm_stitchquantity %}
<dt><span>Количество строчек <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_stitchquantity/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_stitchquantity }}</dd>
{% endif %}
{% if product.sm_buttonhole %}
<dt><span>Режим вымётывания петли <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_buttonhole/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_buttonhole }}</dd>
{% endif %}
{% if product.sm_alphabet %}
<dt><span>Алфавит <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_alphabet/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_alphabet }}</dd>
{% endif %}
{% if product.sm_platformlenght %}
<dt><span>Длина платформы <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_platformlenght/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_platformlenght }} см</dd>
{% endif %}
{% if product.sm_freearm %}
<dt><span>Размеры рукавной платформы (длина/обхват) <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_freearm/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_freearm }} см</dd>
{% endif %}
{% if product.sm_feedwidth %}
<dt><span>Ширина гребёнки транспортера <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_feedwidth/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_feedwidth }} мм</dd>
{% endif %}
{% if product.sm_footheight %}
<dt><span>Высота подъема лапки (нормальная/максимальная) <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_footheight/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_footheight }}</dd>
{% endif %}
{% if product.sm_speedcontrol %}
<dt><span>Регулятор (ограничитель) максимальной скорости <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_speedcontrol/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_speedcontrol }}</dd>
{% endif %}
{% if product.sm_needleupdown %}
<dt><span>Программируемая остановка иглы в верхнем/нижнем положении <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_needleupdown/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_needleupdown }}</dd>
{% endif %}
{% if product.sm_threader %}
<dt><span>Нитевдеватель <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_threader/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_threader }}</dd>
{% endif %}
{% if product.sm_autocutter %}
<dt><span>Автоматическая обрезка нитей</span></dt><dd>{{ product.sm_autocutter }}</dd>
{% endif %}
{% if product.sm_spool %}
<dt><span>Горизонтальное расположение катушки <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_spool/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_spool }}</dd>
{% endif %}
{% if product.sm_presscontrol %}
<dt><span>Регулятор давления лапки <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_presscontrol/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_presscontrol }}</dd>
{% endif %}
{% if product.sm_power %}
<dt><span>Потребляемая мощность <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_power/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_power }} Вт</dd>
{% endif %}
{% if product.sm_light %}
<dt><span>Тип освещения </span></dt><dd>{{ product.sm_light }}</dd>
{% endif %}
{% if product.sm_organizer %}
<dt><span>Органайзер <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_organizer/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_organizer }}</dd>
{% endif %}
{% if product.sm_autostop %}
<dt><span>Автостоп при намотке нитки на шпульку <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_autostop/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_autostop }}</dd>
{% endif %}
{% if product.sm_ruler %}
<dt><span>Линейка на корпусе <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_ruler/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_ruler }}</dd>
{% endif %}
{% if product.sm_cover %}
<dt><span>Чехол <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_cover/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_cover }}</dd>
{% endif %}
{% if product.sm_display %}
<dt><span>Дисплей</span></dt><dd>{{ product.sm_display }}</dd>
{% endif %}
{% if product.sm_russian %}
<dt><span>Русское меню</span></dt><dd>{{ product.sm_russian }}</dd>
{% endif %}
{% if product.sm_advisor %}
<dt><span>Швейный советник <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_advisor/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_advisor }}</dd>
{% endif %}
{% if product.sm_memory %}
<dt><span>Память</span></dt><dd>{{ product.sm_memory }}</dd>
{% endif %}
{% if product.sm_mirror %}
<dt><span>Зеркальное отображение образца строчки</span></dt><dd>{{ product.sm_mirror }}</dd>
{% endif %}
{% if product.sm_startstop %}
<dt><span>Клавиша шитья без педали <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_startstop/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_startstop }}</dd>
{% endif %}
{% if product.sm_kneelift %}
<dt><span>Коленный рычаг подъема лапки <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_kneelift/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_kneelift }}</dd>
{% endif %}
{% if product.sm_diffeed %}
<dt><span>Дифференциальный транспортер ткани <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_diffeed/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_diffeed }}</dd>
{% endif %}
{% if product.sm_easythreading %}
<dt><span>Облегченная заправка петлителей <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_easythreading/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_easythreading }}</dd>
{% endif %}
{% if product.ov_freearm %}
<dt><span>Рукавная платформа</span></dt><dd>{{ product.ov_freearm }}</dd>
{% endif %}
{% if product.sm_needles %}
<dt><span>Стандарт игл <a class="opener-ajax" href="{% url 'django.contrib.flatpages.views.flatpage' url='help/sm_needles/' %}"><img src="{% static 'i/icons/more_icon.png' %}"></a></span></dt><dd>{{ product.sm_needles }}</dd>
{% endif %}
{% if product.enginecounid_name %}
<dt><span>Страна разработки</span></dt><dd>{{ product.enginecounid_name }}</dd>
{% endif %}
{% if product.counid_name %}
<dt><span>Страна производства</span></dt><dd>{{ product.counid_name }}</dd>
{% endif %}
{% if product.warranty %}
<dt><span>Гарантия</span></dt><dd>{{ product.warranty }}</dd>
{% endif %}

{% if product.prom_transporter_type %}
<dt><span>Тип транспортера</span></dt><dd>{{ product.prom_transporter_type }}</dd>
{% endif %}
{% if product.prom_shuttle_type %}
<dt><span>Тип челнока</span></dt><dd>{{ product.prom_shuttle_type }}</dd>
{% endif %}
{% if product.prom_speed %}
<dt><span>Максимальная скорость шитья</span></dt><dd>{{ product.prom_speed }}</dd>
{% endif %}
{% if product.prom_needle_type %}
<dt><span>Размер и тип иглы</span></dt><dd>{{ product.prom_needle_type }}</dd>
{% endif %}
{% if product.prom_stitch_lenght %}
<dt><span>Длина стежка</span></dt><dd>{{ product.prom_stitch_lenght }}</dd>
{% endif %}
{% if product.prom_foot_lift %}
<dt><span>Высота подъема лапки</span></dt><dd>{{ product.prom_foot_lift }}</dd>
{% endif %}
{% if product.prom_fabric_type %}
<dt><span>Тип материала</span></dt><dd>{{ product.prom_fabric_type }}</dd>
{% endif %}
{% if product.prom_oil_type %}
<dt><span>Тип смазки</span></dt><dd>{{ product.prom_oil_type }}</dd>
{% endif %}
{% if product.weight %}
<dt><span>Вес без упаковки</span></dt><dd>{{ product.weight }} кг</dd>
{% endif %}
{% if product.prom_weight %}
<dt><span>Вес в упаковке</span></dt><dd>{{ product.prom_weight }} кг</dd>
{% endif %}
{% if product.prom_cutting %}
<dt><span>Обрезка нити</span></dt><dd>{{ product.prom_cutting }}</dd>
{% endif %}
{% if product.prom_threads_num %}
<dt><span>Количество нитей</span></dt><dd>{{ product.prom_threads_num }}</dd>
{% endif %}
{% if product.prom_power %}
<dt><span>Мощность</span></dt><dd>{{ product.prom_power }}</dd>
{% endif %}
{% if product.prom_bhlenght %}
<dt><span>Длина петли</span></dt><dd>{{ product.prom_bhlenght }}</dd>
{% endif %}
{% if product.prom_overstitch_lenght %}
<dt><span>Максимальная длина обметочного стежка</span></dt><dd>{{ product.prom_overstitch_lenght }}</dd>
{% endif %}
{% if product.prom_overstitch_width %}
<dt><span>Максимальная ширина обметочного стежка</span></dt><dd>{{ product.prom_overstitch_width }}</dd>
{% endif %}
{% if product.prom_stitch_width %}
<dt><span>Ширина зигзагообразной строчки</span></dt><dd>{{ product.prom_stitch_width }}</dd>
{% endif %}
{% if product.prom_needle_width %}
<dt><span>Расстояние между иглами</span></dt><dd>{{ product.prom_needle_width }}</dd>
{% endif %}
{% if product.prom_needle_num %}
<dt><span>Количество игл</span></dt><dd>{{ product.prom_needle_num }}</dd>
{% endif %}
{% if product.prom_platform_type %}
<dt><span>Тип платформы</span></dt><dd>{{ product.prom_platform_type }}</dd>
{% endif %}
{% if product.prom_button_diaouter %}
<dt><span>Наружный диаметр пуговицы</span></dt><dd>{{ product.prom_button_diaouter }}</dd>
{% endif %}
{% if product.prom_button_diainner %}
<dt><span>Внутренний диаметр пуговицы</span></dt><dd>{{ product.prom_button_diainner }}</dd>
{% endif %}
{% if product.prom_needle_height %}
<dt><span>Ход игловодителя</span></dt><dd>{{ product.prom_needle_height }}</dd>
{% endif %}
{% if product.prom_stitch_type %}
<dt><span>Тип стежка</span></dt><dd>{{ product.prom_stitch_type }}</dd>
{% endif %}
{% if product.prom_autothread %}
<dt><span>Автоматический нитеотводчик</span></dt><dd>{{ product.prom_autothread }}</dd>
{% endif %}
</dl>

{% if 'images/'|add:product.manufacturer.name|add:'/stitches/'|add:product.code|add:'_stitches.jpg'|file_exists or product.stitches %}
<h2>Строчки {{ product.title }}:</h2>

<p>
{% if 'images/'|add:product.manufacturer.name|add:'/stitches/'|add:product.code|add:'_stitches.jpg'|file_exists %}
<img src="{{ MEDIA_URL }}/images/{{ product.manufacturer.name }}/stitches/{{ product.code }}_stitches.jpg" alt="Строчки швейной машины {{ product.title }}">
{% endif %}
{% if product.stitches %}
{{ product.stitches|safe }}
{% endif %}
</p>

{% endif %}

{% if product.spec %}
<p itemprop="description">{{ product.spec|safe }}</p>
{% endif %}

{% if product.complect %}
<h2>Комплектация</h2>
<p>{{ product.complect|safe }}</p>
{% endif %}

</div>

</div> <!--- /product-page --->
{% endblock %}
